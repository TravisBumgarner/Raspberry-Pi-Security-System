(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):e.FakeXMLHttpRequest=t()})(this,function(){"use strict";var e=function d(e,t,r,n){this.type=e;this.bubbles=t;this.cancelable=r;this.target=n};e.prototype={stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=true}};var t={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function r(e){var t;if(typeof DOMParser!="undefined"){var r=new DOMParser;t=r.parseFromString(e,"text/xml")}else{t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}return t}var n={"Accept-Charset":true,"Accept-Encoding":true,Connection:true,"Content-Length":true,Cookie:true,Cookie2:true,"Content-Transfer-Encoding":true,Date:true,Expect:true,Host:true,"Keep-Alive":true,Referer:true,TE:true,Trailer:true,"Transfer-Encoding":true,Upgrade:true,"User-Agent":true,Via:true};function s(e,t){t.addEventListener(e,function(r){var n=t["on"+e];if(n&&typeof n=="function"){n(r)}})}function i(){this._eventListeners={};var e=["loadstart","progress","load","abort","loadend"];for(var t=e.length-1;t>=0;t--){s(e[t],this)}}i.prototype={addEventListener:function y(e,t){this._eventListeners[e]=this._eventListeners[e]||[];this._eventListeners[e].push(t)},removeEventListener:function v(e,t){var r=this._eventListeners[e]||[];for(var n=0,s=r.length;n<s;++n){if(r[n]==t){return r.splice(n,1)}}},dispatchEvent:function m(e){var t=e.type;var r=this._eventListeners[t]||[];for(var n=0;n<r.length;n++){if(typeof r[n]=="function"){r[n].call(this,e)}else{r[n].handleEvent(e)}}return!!e.defaultPrevented},_progress:function g(t,r,n){var s=new e("progress");s.target=this;s.lengthComputable=t;s.loaded=r;s.total=n;this.dispatchEvent(s)}};function o(){i.call(this);this.readyState=o.UNSENT;this.requestHeaders={};this.requestBody=null;this.status=0;this.statusText="";this.upload=new i}o.prototype=new i;o.UNSENT=0;o.OPENED=1;o.HEADERS_RECEIVED=2;o.LOADING=3;o.DONE=4;var a={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4,async:true,withCredentials:false,open:function _(e,t,r,n,s){this.method=e;this.url=t;this.async=typeof r=="boolean"?r:true;this.username=n;this.password=s;this.responseText=null;this.responseXML=null;this.requestHeaders={};this.sendFlag=false;this._readyStateChange(o.OPENED)},setRequestHeader:function b(e,t){l(this);if(n[e]||/^(Sec-|Proxy-)/.test(e)){throw new Error('Refused to set unsafe header "'+e+'"')}if(this.requestHeaders[e]){this.requestHeaders[e]+=","+t}else{this.requestHeaders[e]=t}},send:function E(t){l(this);if(!/^(get|head)$/i.test(this.method)){if(!this.requestHeaders["Content-Type"]&&!(t||"").toString().match("FormData")){this.requestHeaders["Content-Type"]="text/plain;charset=UTF-8"}this.requestBody=t}this.errorFlag=false;this.sendFlag=this.async;this._readyStateChange(o.OPENED);if(typeof this.onSend=="function"){this.onSend(this)}this.dispatchEvent(new e("loadstart",false,false,this))},abort:function q(){this.aborted=true;this.responseText=null;this.errorFlag=true;this.requestHeaders={};if(this.readyState>o.UNSENT&&this.sendFlag){this._readyStateChange(o.DONE);this.sendFlag=false}this.readyState=o.UNSENT;this.dispatchEvent(new e("abort",false,false,this));if(typeof this.onerror==="function"){this.onerror()}},getResponseHeader:function w(e){if(this.readyState<o.HEADERS_RECEIVED){return null}if(/^Set-Cookie2?$/i.test(e)){return null}e=e.toLowerCase();for(var t in this.responseHeaders){if(t.toLowerCase()==e){return this.responseHeaders[t]}}return null},getAllResponseHeaders:function k(){if(this.readyState<o.HEADERS_RECEIVED){return""}var e="";for(var t in this.responseHeaders){if(this.responseHeaders.hasOwnProperty(t)&&!/^Set-Cookie2?$/i.test(t)){e+=t+": "+this.responseHeaders[t]+"\r\n"}}return e},_readyStateChange:function S(t){this.readyState=t;if(typeof this.onreadystatechange=="function"){this.onreadystatechange(new e("readystatechange"))}this.dispatchEvent(new e("readystatechange"));if(this.readyState==o.DONE){this.dispatchEvent(new e("load",false,false,this));this.dispatchEvent(new e("loadend",false,false,this))}},_setResponseHeaders:function R(e){this.responseHeaders={};for(var t in e){if(e.hasOwnProperty(t)){this.responseHeaders[t]=e[t]}}if(this.async){this._readyStateChange(o.HEADERS_RECEIVED)}else{this.readyState=o.HEADERS_RECEIVED}},_setResponseBody:function x(e){h(this);c(this);f(e);var t=this.chunkSize||10;var n=0;this.responseText="";do{if(this.async){this._readyStateChange(o.LOADING)}this.responseText+=e.substring(n,n+t);n+=t}while(n<e.length);var s=this.getResponseHeader("Content-Type");if(this.responseText&&(!s||/(text\/xml)|(application\/xml)|(\+xml)/.test(s))){try{this.responseXML=r(this.responseText)}catch(i){}}if(this.async){this._readyStateChange(o.DONE)}else{this.readyState=o.DONE}},respond:function P(e,r,n){this._setResponseHeaders(r||{});this.status=typeof e=="number"?e:200;this.statusText=t[this.status];this._setResponseBody(n||"")}};for(var u in a){o.prototype[u]=a[u]}function l(e){if(e.readyState!==o.OPENED){throw new Error("INVALID_STATE_ERR")}if(e.sendFlag){throw new Error("INVALID_STATE_ERR")}}function h(e){if(e.readyState==o.DONE){throw new Error("Request done")}}function c(e){if(e.async&&e.readyState!=o.HEADERS_RECEIVED){throw new Error("No headers received")}}function f(e){if(typeof e!="string"){var t=new Error("Attempted to respond to fake XMLHttpRequest with "+e+", which is not a string.");t.name="InvalidBodyException";throw t}}var p=o;return p});(function(e,t){var r=t();if(typeof define==="function"&&define.amd){define("restli-utils",function(){return r})}if(typeof exports==="object"){module.exports=r}e["@linkedin/restli-utils"]=r})(this,function(){var e=function t(e,r,n){function s(o,a){if(!r[o]){if(!e[o]){var u=typeof require=="function"&&require;if(!a&&u)return u(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=r[o]={exports:{}};e[o][0].call(h.exports,function(t){var r=e[o][1][t];return s(r?r:t)},h,h.exports,t,e,r,n)}return r[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<n.length;o++)s(n[o]);return s}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});function n(e){return e&&e.__esModule?e:{"default":e}}var s=e("./parser");var i=n(s);var o=new i["default"];var a=/(%2C|%28|%29|%27|%3A)/g;var u=/(%2C|%28|%29|%27|%3A)/;function l(e,t){if(!t){return decodeURIComponent(e)}else{if(u.test(e)){return e.replace(a,unescape)}else{return e}}}o.yy.restliUnescape=l;o.yy.reduced=false;r["default"]={paramDecode:function h(e){var t=this;return e.split("&").reduce(function(e,r){if(!r.length){return e}if(r.indexOf("=")===0){return e}var n=r.split("=");var s=n[0];var i=n[1];if(s==="''"){s=""}if(i===undefined||i===""){i="''"}e[decodeURIComponent(s)]=t.decode(i);return e},{})},decode:function c(e){return this._decode(e,false)},reducedDecode:function f(e){return this._decode(e,true)},_decode:function p(e,t){o.yy.reduced=t;return o.parse(e)}};t.exports=r["default"]},{"./parser":3}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=/[,()':]/g;var s=/[,()':]/;r["default"]={encode:function i(e){e=JSON.parse(JSON.stringify(e));if(typeof e!=="object"){throw new Error("You must pass either an array or an object to the encode function.")}return this._process(e,false)},reducedEncode:function o(e){e=JSON.parse(JSON.stringify(e));if(typeof e!=="object"){throw new Error("You must pass either an array or an object to the reducedEncode function.")}return this._process(e,true)},paramEncode:function a(e){e=JSON.parse(JSON.stringify(e));if(e instanceof Array||typeof e!=="object"){throw new Error("You must pass an object to the paramEncode function. Use arrayParamEncode.")}var t=[];for(var r in e){if(!e.hasOwnProperty(r)){continue}t.push(this._processPrimitive(r)+"="+this._process(e[r],false))}return t.join("&")},arrayParamEncode:function u(e){return this.paramEncode(this._arrayParamEncode(e))},_arrayParamEncode:function l(e){e=JSON.parse(JSON.stringify(e));if(!(e instanceof Array)){throw new Error("You must pass an array to the arrayParamEncode function.")}return e.reduce(function(e,t){if(!t||!t.hasOwnProperty("name")||!t.hasOwnProperty("value")){throw new Error("Objects passed to the arrayParamEncode function must have name and value properties.")}if(typeof t.value==="object"&&t.value!==null){throw new Error("Only primitives may be passed to arrayParamEncode as item values.")}var r=t.name;var n=e.hasOwnProperty(r);if(!n){e[r]=t.value}else if(n&&typeof e[r]==="object"&&e[r]!==null){e[r].push(t.value)}else{e[r]=[e[r],t.value]}return e},{})},_process:function h(e,t){if(e instanceof Array){return this._processArray(e,t)}else if(typeof e==="object"&&e!==null){return this._processObject(e,t)}else{return this._processPrimitive(e,t)}},_processArray:function c(e,t){var r=new Array(e.length);for(var n=0;n<e.length;n++){r[n]=this._process(e[n],t)}return"List("+r.join(",")+")"},_processObject:function f(e,t){var r=[];for(var n in e){if(!e.hasOwnProperty(n)){continue}r.push(this._processPrimitive(n,t)+":"+this._process(e[n],t))}return"("+r.join(",")+")"},_processPrimitive:function p(e,t){if(e===""){return"''"}else if(t&&typeof e==="string"&&s.test(e)){return e.replace(n,escape)}else if(!t){return encodeURIComponent(e).replace(n,escape)}else{return e}}};t.exports=r["default"]},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){var e=function f(e,t,r,n){for(r=r||{},n=e.length;n--;r[e[n]]=t);return r},t=[1,5],r=[1,6],n=[1,7],s=[1,8],i=[5,12,13],o=[1,17],a=[1,18],u=[12,13];var l={trace:function p(){},yy:{},symbols_:{error:2,wrapper:3,item:4,EOF:5,array:6,object:7,VALUE:8,EMPTYSTRING:9,"List(":10,items:11,")":12,",":13,"(":14,kvpairs:15,kvpair:16,key:17,":":18,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:"VALUE",9:"EMPTYSTRING",10:"List(",12:")",13:",",14:"(",18:":"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,1],[6,3],[6,2],[11,1],[11,3],[7,3],[7,2],[15,1],[15,3],[17,1],[17,1],[16,3]],performAction:function d(e,t,r,n,s,i,o){var a=i.length-1;switch(s){case 1:return JSON.parse(i[a-1]);break;case 2:case 3:case 14:this.$=i[a];break;case 4:this.$='"'+n.restliUnescape(i[a],n.reduced).replace('"','\\"')+'"';break;case 5:this.$='""';break;case 6:this.$="["+i[a-1]+"]";break;case 7:this.$="[]";break;case 8:case 12:this.$=""+i[a];break;case 9:case 13:this.$=""+i[a-2]+","+i[a];break;case 10:this.$="{"+i[a-1]+"}";break;case 11:this.$="{}";break;case 15:this.$="";break;case 16:this.$='"'+n.restliUnescape(i[a-2],n.reduced).replace('"','\\"')+'":'+i[a];break}},table:[{3:1,4:2,6:3,7:4,8:t,9:r,10:n,14:s},{1:[3]},{5:[1,9]},e(i,[2,2]),e(i,[2,3]),e(i,[2,4]),e(i,[2,5]),{4:12,6:3,7:4,8:t,9:r,10:n,11:10,12:[1,11],14:s},{8:o,9:a,12:[1,14],15:13,16:15,17:16},{1:[2,1]},{12:[1,19],13:[1,20]},e(i,[2,7]),e(u,[2,8]),{12:[1,21],13:[1,22]},e(i,[2,11]),e(u,[2,12]),{18:[1,23]},{18:[2,14]},{18:[2,15]},e(i,[2,6]),{4:24,6:3,7:4,8:t,9:r,10:n,14:s},e(i,[2,10]),{8:o,9:a,16:25,17:16},{4:26,6:3,7:4,8:t,9:r,10:n,14:s},e(u,[2,9]),e(u,[2,13]),e(u,[2,16])],defaultActions:{9:[2,1],17:[2,14],18:[2,15]},parseError:function y(e,t){if(t.recoverable){this.trace(e)}else{var r=function n(e,t){this.message=e;this.hash=t};r.prototype=new Error;throw new r(e,t)}},parse:function v(e){var t=this,r=[0],n=[],s=[null],i=[],o=this.table,a="",u=0,l=0,h=0,c=2,f=1;var p=i.slice.call(arguments,1);var d=Object.create(this.lexer);var y={yy:{}};for(var v in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,v)){y.yy[v]=this.yy[v]}}d.setInput(e,y.yy);y.yy.lexer=d;y.yy.parser=this;if(typeof d.yylloc=="undefined"){d.yylloc={}}var m=d.yylloc;i.push(m);var g=d.options&&d.options.ranges;if(typeof y.yy.parseError==="function"){this.parseError=y.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function _(e){r.length=r.length-2*e;s.length=s.length-e;i.length=i.length-e}e:var b=function j(){var e;e=d.lex()||f;if(typeof e!=="number"){e=t.symbols_[e]||e}return e};var E,q,w,k,S,R,x={},P,T,O,N;while(true){w=r[r.length-1];if(this.defaultActions[w]){k=this.defaultActions[w]}else{if(E===null||typeof E=="undefined"){E=b()}k=o[w]&&o[w][E]}if(typeof k==="undefined"||!k.length||!k[0]){var I="";N=[];for(P in o[w]){if(this.terminals_[P]&&P>c){N.push("'"+this.terminals_[P]+"'")}}if(d.showPosition){I="Parse error on line "+(u+1)+":\n"+d.showPosition()+"\nExpecting "+N.join(", ")+", got '"+(this.terminals_[E]||E)+"'"}else{I="Parse error on line "+(u+1)+": Unexpected "+(E==f?"end of input":"'"+(this.terminals_[E]||E)+"'")}this.parseError(I,{text:d.match,token:this.terminals_[E]||E,line:d.yylineno,loc:m,expected:N})}if(k[0]instanceof Array&&k.length>1){throw new Error("Parse Error: multiple actions possible at state: "+w+", token: "+E)}switch(k[0]){case 1:r.push(E);s.push(d.yytext);i.push(d.yylloc);r.push(k[1]);E=null;if(!q){l=d.yyleng;a=d.yytext;u=d.yylineno;m=d.yylloc;if(h>0){h--}}else{E=q;q=null}break;case 2:T=this.productions_[k[1]][1];x.$=s[s.length-T];x._$={first_line:i[i.length-(T||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(T||1)].first_column,last_column:i[i.length-1].last_column};if(g){x._$.range=[i[i.length-(T||1)].range[0],i[i.length-1].range[1]]}R=this.performAction.apply(x,[a,l,u,y.yy,k[1],s,i].concat(p));if(typeof R!=="undefined"){return R}if(T){r=r.slice(0,-1*T*2);s=s.slice(0,-1*T);i=i.slice(0,-1*T)}r.push(this.productions_[k[1]][0]);s.push(x.$);i.push(x._$);O=o[r[r.length-2]][r[r.length-1]];r.push(O);break;case 3:return true}}return true}};var h=function(){var e={EOF:1,parseError:function t(e,r){if(this.yy.parser){this.yy.parser.parseError(e,r)}else{throw new Error(e)}},setInput:function r(e,t){this.yy=t||this.yy||{};this._input=e;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function n(){var e=this._input[0];this.yytext+=e;this.yyleng++;this.offset++;this.match+=e;this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);if(t){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return e},unput:function s(e){var t=e.length;var r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-t);this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(r.length-1){this.yylineno-=r.length-1}var s=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t};if(this.options.ranges){this.yylloc.range=[s[0],s[0]+this.yyleng-t]}this.yyleng=this.yytext.length;return this},more:function i(){this._more=true;return this},reject:function o(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function a(e){this.unput(this.match.slice(e))},pastInput:function u(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function l(){var e=this.match;if(e.length<20){e+=this._input.substr(0,20-e.length)}return(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function h(){var e=this.pastInput();var t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function c(e,t){var r,n,s;if(this.options.backtrack_lexer){s={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){s.yylloc.range=this.yylloc.range.slice(0)}}n=e[0].match(/(?:\r\n?|\n).*/g);if(n){this.yylineno+=n.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length};this.yytext+=e[0];this.match+=e[0];this.matches=e;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(e[0].length);this.matched+=e[0];r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(r){return r}else if(this._backtrack){for(var i in s){this[i]=s[i]}return false}return false},next:function f(){if(this.done){return this.EOF}if(!this._input){this.done=true}var e,t,r,n;if(!this._more){this.yytext="";this.match=""}var s=this._currentRules();for(var i=0;i<s.length;i++){r=this._input.match(this.rules[s[i]]);if(r&&(!t||r[0].length>t[0].length)){t=r;n=i;if(this.options.backtrack_lexer){e=this.test_match(r,s[i]);if(e!==false){return e}else if(this._backtrack){t=false;continue}else{return false}}else if(!this.options.flex){break}}}if(t){e=this.test_match(t,s[n]);if(e!==false){return e}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function p(){var e=this.next();if(e){return e}else{return this.lex()}},begin:function d(e){this.conditionStack.push(e)},popState:function y(){var e=this.conditionStack.length-1;if(e>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function v(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions["INITIAL"].rules}},topState:function m(e){e=this.conditionStack.length-1-Math.abs(e||0);if(e>=0){return this.conditionStack[e]}else{return"INITIAL"}},pushState:function g(e){this.begin(e)},stateStackSize:function _(){return this.conditionStack.length},options:{},performAction:function b(e,t,r,n){var s=n;switch(r){case 0:return 10;break;case 1:return 14;break;case 2:return 12;break;case 3:return 18;break;case 4:return 13;break;case 5:return 9;break;case 6:return 8;break;case 7:return 5;break;case 8:return"INVALID";break}},rules:[/^(?:List\()/,/^(?:\()/,/^(?:\))/,/^(?::)/,/^(?:,)/,/^(?:'')/,/^(?:[^\)\:\,]+)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8],inclusive:true}}};return e}();l.lexer=h;function c(){this.yy={}}c.prototype=l;l.Parser=c;return c}();r["default"]=n;t.exports=r["default"]},{}],"@linkedin/restli-utils":[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});function n(e){return e&&e.__esModule?e:{"default":e}}var s=e("./encoder");var i=n(s);var o=e("./decoder");var a=n(o);r["default"]={encoder:i["default"],decoder:a["default"]};t.exports=r["default"]},{"./decoder":1,"./encoder":2}]},{},["@linkedin/restli-utils"]);return e("@linkedin/restli-utils")});(function(e,t){if(typeof define==="function"&&define.amd){define(["exports","bower_components/FakeXMLHttpRequest/fake_xml_http_request"],t)}else if(typeof exports!=="undefined"){t(exports,require("bower_components/FakeXMLHttpRequest/fake_xml_http_request"))}else{var r={exports:{}};t(r.exports,e.FakeXMLHttpRequest);e.bigpipeConcat=r.exports}})(this,function(e,t){"use strict";var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var n=function v(e,t,r){var n=true;e:while(n){var s=e,i=t,o=r;n=false;if(s===null)s=Function.prototype;var a=Object.getOwnPropertyDescriptor(s,i);if(a===undefined){var u=Object.getPrototypeOf(s);if(u===null){return undefined}else{e=u;t=i;r=o;n=true;a=u=undefined;continue e}}else if("value"in a){return a.value}else{var l=a.get;if(l===undefined){return undefined}return l.call(o)}}};function s(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function o(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var a=s(t);var u=Number.MAX_VALUE;var l=function(e){o(t,e);function t(){i(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);this.chunkSize=u;a["default"].call(this)}r(t,[{key:"open",value:function s(){n(Object.getPrototypeOf(t.prototype),"open",this).apply(this,arguments);this.method=this.method&&this.method.toUpperCase()}},{key:"_createMarkerName",value:function l(e){return"mark_bigpipe_"+e}},{key:"_hasPerformanceApi",value:function h(){if(window&&window.performance&&window.performance.mark&&window.performance.measure){return true}return false}},{key:"fulfillPendingRequest",value:function c(e){var t=_bpr.requestSupervisor.responseTable[e];var r=t.responseData;var n=t.status;if(this._hasPerformanceApi()){var s=this._createMarkerName(e);window.performance.mark(s+"_end");window.performance.measure(s+"_phase",s+"_start",s+"_end")}this.respond(n,{"Content-Type":"application/json"},r)}},{key:"send",value:function f(e){var r=this.url;if(this._hasPerformanceApi()){var s=this._createMarkerName(r);window.performance.mark(s+"_start")}if(_bpr.isPresentInTable("response",r)){this.fulfillPendingRequest(r);_bpr.deleteJqueryRequest(r)}else{var i={xhr:this,url:this.url,method:this.method,async:this.async,username:this.username||"",password:this.password||"",requestHeaders:this.requestHeaders,postData:this.method==="POST"||this.method==="PUT"?e:null,timeout:this.timeout,isJqueryRequest:false,events:{onreadystatechange:this.onreadystatechange,onload:this.onload,onerror:this.onerror,onprogress:this.onprogress,onloadstart:this.onloadstart,onabort:this.onabort,onloadend:this.onloadend,ontimeout:this.ontimeout},uploadEvents:{onload:this.upload.onload,onerror:this.upload.onerror,onprogress:this.upload.onprogress,onloadstart:this.upload.onloadstart,onabort:this.upload.onabort,onloadend:this.upload.onloadend,ontimeout:this.upload.ontimeout}};if(this.responseType){i["responseType"]=this.responseType}var o=_bpr.isPresentInTable("jQuery",r);if(o){i["isJqueryRequest"]=true;i["jqueryOptions"]=o.slice(-1)[0]}if(_bpr.requestSupervisor.terminatorCalled||this.method!=="GET"||_bpr.isBlacklistedUrl(r)){_bpr.refireRequest(i);_bpr.deleteJqueryRequest(r);return}if(!_bpr.isPresentInTable("request",r)){_bpr.requestSupervisor.requestTable[r]=[]}_bpr.requestSupervisor.requestTable[r].push(i);n(Object.getPrototypeOf(t.prototype),"send",this).call(this,e)}}}]);return t}(a["default"]);function h(){return!(window&&window.appEnvironment==="node")}window._isBigPipeMode=function(){if(h()){var e=document.getElementsByName("renderingMode");if(e.length!==1){return false}return["BIGPIPE","SSRPIPE"].indexOf(e[0].getAttribute("data-mode"))>-1}else{return false}};function c(e,t){var r=document.querySelector('meta[name="'+e+'"]');if(r){return r.getAttribute("content")}else{return t}}var f=null;var p=c("bigpipeResponseTimeout",12e3);var d=c("bigpipeBlacklistUrls","");var y=function(){function e(){i(this,e);if(!f){var t=setTimeout(this._handleResponseTimeout.bind(this),p);var r=[];if(d!==""){r=JSON.parse(d).map(function(e){return new RegExp(e)})}this.requestSupervisor={requestTable:{},responseTable:{},jqueryRequests:{},originalXHR:null,originalJqueryAjax:null,terminatorCalled:false,pageRendered:false,isInitialPageLoaded:false,responseTimer:t,blacklistUrlsRegex:r,VERSION:1};this._injectFakeXHR();f=this;this._setupRequestSupervisorEventListener();return f}else{throw new Error("There can be only one instance of RequestManager.")}}r(e,[{key:"_replaceNavFragment",value:function t(e,r,n){var s=document.getElementById(n);var i=document.getElementById(e);var o=document.getElementById(r);i.removeChild(o);while(s.hasChildNodes()){i.appendChild(s.removeChild(s.firstChild))}}},{key:"_setupRequestSupervisorEventListener",value:function n(){var e="datalet-bpr-guid";var t=e.length;var r="terminatorlet";var n="navlet-header";var s="navlet-footer";var i=this;function o(a){var u=a.target;if(u.tagName==="IMG"){var l=u.getAttribute("class");l=l?l.split(" "):[];if(l.length===1&&l[0].substring(0,t)===e){var h=l[0];i.response(h)}if(l.length===1&&l[0]===r){i.done();document.removeEventListener("load",o,true)}if(l.length===1&&l[0]===n){i._replaceNavFragment("nav-head-container","nav-header",n)}if(l.length===1&&l[0]===s){i._replaceNavFragment("nav-foot-container","nav-footer",s)}}}document.addEventListener("load",o,true)}},{key:"isBlacklistedUrl",value:function s(e){var t=this.requestSupervisor.blacklistUrlsRegex.some(function(t){return t.test(e)},this);return t}},{key:"isPresentInTable",value:function o(e,t){var r=null;if(e==="request"){r=this.requestSupervisor.requestTable}else if(e==="response"){r=this.requestSupervisor.responseTable}else if(e==="jQuery"){r=this.requestSupervisor.jqueryRequests}else{throw new Error("Invalid table name.")}return r[t]}},{key:"deleteJqueryRequest",value:function a(e){if(this.isPresentInTable("jQuery",e)){delete this.requestSupervisor.jqueryRequests[e]}}},{key:"_deleteRequest",value:function u(e){delete this.requestSupervisor.requestTable[e];this.deleteJqueryRequest(e)}},{key:"_handleResponseTimeout",value:function h(){console.info("Terminator datalet is not seen within "+p+" ms.")}},{key:"_injectFakeXHR",value:function c(){this.requestSupervisor.originalXHR=XMLHttpRequest;window.XMLHttpRequest=l}},{key:"response",value:function y(e){var t=e;if(typeof e!=="object"){t=JSON.parse(this._getResponseData(e))}var r=t.request;var n=t.status;var s=this._getResponseData(t.body);var i={url:r,status:n,responseData:s};this.requestSupervisor.responseTable[r]=i;var o=this.requestSupervisor.requestTable[r];if(o){o.forEach(function(e){var t=e.xhr;t.fulfillPendingRequest(r)});this._deleteRequest(r)}}},{key:"_getResponseData",value:function v(e){var t=document.getElementById(e);var r={};if(t){t.normalize();r=t.firstChild.nodeValue}return r}},{key:"done",value:function m(){if(this.requestSupervisor.terminatorCalled){throw new Error("Terminator cannot be called multiple times.")}this.requestSupervisor.terminatorCalled=true;this._clearResponseTimer();this._fullFillPendingRequests();this._refirePendingRequests();if(this.requestSupervisor.pageRendered){this._reset()}}},{key:"_fullFillPendingRequests",value:function g(){var e=this;var t=this.requestSupervisor.requestTable;var r=Object.keys(t);r.forEach(function(t){if(e.isPresentInTable("response",t)){var r=e.requestSupervisor.requestTable[t];if(r){r.forEach(function(e){e.xhr.fulfillPendingRequest(t)});e._deleteRequest(t)}}})}},{key:"_refirePendingRequests",value:function _(){var e=this;var t=Object.keys(this.requestSupervisor.requestTable);t.forEach(function(t){var r=e.requestSupervisor.requestTable[t];r.forEach(function(t){e.refireRequest(t)},e)},this)}},{key:"refireRequest",value:function b(e){var t=this;var r=window.XMLHttpRequest;window.XMLHttpRequest=this.requestSupervisor.originalXHR;if(e.isJqueryRequest){(function(){var r=e["jqueryOptions"]["originalPromise"];t.requestSupervisor.originalJqueryAjax(e["jqueryOptions"]).then(function(e,t,n){r.resolve(e,t,n)},function(e,t,n){r.reject(e,t,n)})})()}else{(function(){var t=new XMLHttpRequest;t.open(e.method,e.url,e.async,e.username,e.password);var r=e.requestHeaders;for(var n in r){t.setRequestHeader(n,r[n])}if(e.timeout){t.timeout=e.timeout}if(e.responseType){t.responseType=e.responseType}var s=e.events;var i=Object.keys(s);i.forEach(function(e){if(typeof s[e]==="function"){t[e]=function(){s[e].call(t)}}});var o=e.uploadEvents;var a=Object.keys(o);a.forEach(function(e){if(typeof o[e]==="function"){t.upload[e]=function(){o[e].call(t)}}});if(e.postData){t.send(e.postData)}else{t.send()}})()}window.XMLHttpRequest=r}},{key:"_resetRequestSupervisor",value:function E(){this.requestSupervisor.responseTable={};this.requestSupervisor.requestTable={};this.requestSupervisor.jqueryRequests={}}},{key:"rendered",value:function q(){if(this.requestSupervisor.pageRendered){throw new Error("Initial page render cannot be called multiple times.")}this.requestSupervisor.pageRendered=true;if(this.requestSupervisor.terminatorCalled){this._reset()}}},{key:"_reset",value:function w(){if(this.requestSupervisor.isInitialPageLoaded){throw new Error("Request manager cannot be reset multiple times.")}this._resetRequestSupervisor();this.requestSupervisor.isInitialPageLoaded=true;window.XMLHttpRequest=this.requestSupervisor.originalXHR;jQuery.ajax=this.requestSupervisor.originalJqueryAjax}},{key:"_clearResponseTimer",value:function k(){var e=this.requestSupervisor.responseTimer;if(e){clearTimeout(e);this.requestSupervisor.responseTimer=null}}}]);return e}();window._bpr=new y});